{"version":3,"file":"hookable-48cbdad6.js","sources":["../../node_modules/.pnpm/hookable@5.4.2/node_modules/hookable/dist/index.mjs"],"sourcesContent":["function flatHooks(configHooks, hooks = {}, parentName) {\n  for (const key in configHooks) {\n    const subHook = configHooks[key];\n    const name = parentName ? `${parentName}:${key}` : key;\n    if (typeof subHook === \"object\" && subHook !== null) {\n      flatHooks(subHook, hooks, name);\n    } else if (typeof subHook === \"function\") {\n      hooks[name] = subHook;\n    }\n  }\n  return hooks;\n}\nfunction mergeHooks(...hooks) {\n  const finalHooks = {};\n  for (const hook of hooks) {\n    const flatenHook = flatHooks(hook);\n    for (const key in flatenHook) {\n      if (finalHooks[key]) {\n        finalHooks[key].push(flatenHook[key]);\n      } else {\n        finalHooks[key] = [flatenHook[key]];\n      }\n    }\n  }\n  for (const key in finalHooks) {\n    if (finalHooks[key].length > 1) {\n      const array = finalHooks[key];\n      finalHooks[key] = (...arguments_) => serial(array, (function_) => function_(...arguments_));\n    } else {\n      finalHooks[key] = finalHooks[key][0];\n    }\n  }\n  return finalHooks;\n}\nfunction serial(tasks, function_) {\n  return tasks.reduce((promise, task) => promise.then(() => function_(task)), Promise.resolve());\n}\nfunction serialCaller(hooks, arguments_) {\n  return hooks.reduce((promise, hookFunction) => promise.then(() => hookFunction.apply(void 0, arguments_)), Promise.resolve());\n}\nfunction parallelCaller(hooks, arguments_) {\n  return Promise.all(hooks.map((hook) => hook.apply(void 0, arguments_)));\n}\nfunction callEachWith(callbacks, argument0) {\n  for (const callback of callbacks) {\n    callback(argument0);\n  }\n}\n\nclass Hookable {\n  constructor() {\n    this._hooks = {};\n    this._before = void 0;\n    this._after = void 0;\n    this._deprecatedMessages = void 0;\n    this._deprecatedHooks = {};\n    this.hook = this.hook.bind(this);\n    this.callHook = this.callHook.bind(this);\n    this.callHookWith = this.callHookWith.bind(this);\n  }\n  hook(name, function_, options = {}) {\n    if (!name || typeof function_ !== \"function\") {\n      return () => {\n      };\n    }\n    const originalName = name;\n    let dep;\n    while (this._deprecatedHooks[name]) {\n      dep = this._deprecatedHooks[name];\n      name = dep.to;\n    }\n    if (dep && !options.allowDeprecated) {\n      let message = dep.message;\n      if (!message) {\n        message = `${originalName} hook has been deprecated` + (dep.to ? `, please use ${dep.to}` : \"\");\n      }\n      if (!this._deprecatedMessages) {\n        this._deprecatedMessages = /* @__PURE__ */ new Set();\n      }\n      if (!this._deprecatedMessages.has(message)) {\n        console.warn(message);\n        this._deprecatedMessages.add(message);\n      }\n    }\n    this._hooks[name] = this._hooks[name] || [];\n    this._hooks[name].push(function_);\n    return () => {\n      if (function_) {\n        this.removeHook(name, function_);\n        function_ = void 0;\n      }\n    };\n  }\n  hookOnce(name, function_) {\n    let _unreg;\n    let _function = (...arguments_) => {\n      if (typeof _unreg === \"function\") {\n        _unreg();\n      }\n      _unreg = void 0;\n      _function = void 0;\n      return function_(...arguments_);\n    };\n    _unreg = this.hook(name, _function);\n    return _unreg;\n  }\n  removeHook(name, function_) {\n    if (this._hooks[name]) {\n      const index = this._hooks[name].indexOf(function_);\n      if (index !== -1) {\n        this._hooks[name].splice(index, 1);\n      }\n      if (this._hooks[name].length === 0) {\n        delete this._hooks[name];\n      }\n    }\n  }\n  deprecateHook(name, deprecated) {\n    this._deprecatedHooks[name] = typeof deprecated === \"string\" ? { to: deprecated } : deprecated;\n    const _hooks = this._hooks[name] || [];\n    this._hooks[name] = void 0;\n    for (const hook of _hooks) {\n      this.hook(name, hook);\n    }\n  }\n  deprecateHooks(deprecatedHooks) {\n    Object.assign(this._deprecatedHooks, deprecatedHooks);\n    for (const name in deprecatedHooks) {\n      this.deprecateHook(name, deprecatedHooks[name]);\n    }\n  }\n  addHooks(configHooks) {\n    const hooks = flatHooks(configHooks);\n    const removeFns = Object.keys(hooks).map((key) => this.hook(key, hooks[key]));\n    return () => {\n      for (const unreg of removeFns.splice(0, removeFns.length)) {\n        unreg();\n      }\n    };\n  }\n  removeHooks(configHooks) {\n    const hooks = flatHooks(configHooks);\n    for (const key in hooks) {\n      this.removeHook(key, hooks[key]);\n    }\n  }\n  callHook(name, ...arguments_) {\n    return this.callHookWith(serialCaller, name, ...arguments_);\n  }\n  callHookParallel(name, ...arguments_) {\n    return this.callHookWith(parallelCaller, name, ...arguments_);\n  }\n  callHookWith(caller, name, ...arguments_) {\n    const event = this._before || this._after ? { name, args: arguments_, context: {} } : void 0;\n    if (this._before) {\n      callEachWith(this._before, event);\n    }\n    const result = caller(this._hooks[name] || [], arguments_);\n    if (result instanceof Promise) {\n      return result.finally(() => {\n        if (this._after && event) {\n          callEachWith(this._after, event);\n        }\n      });\n    }\n    if (this._after && event) {\n      callEachWith(this._after, event);\n    }\n    return result;\n  }\n  beforeEach(function_) {\n    this._before = this._before || [];\n    this._before.push(function_);\n    return () => {\n      const index = this._before.indexOf(function_);\n      if (index !== -1) {\n        this._before.splice(index, 1);\n      }\n    };\n  }\n  afterEach(function_) {\n    this._after = this._after || [];\n    this._after.push(function_);\n    return () => {\n      const index = this._after.indexOf(function_);\n      if (index !== -1) {\n        this._after.splice(index, 1);\n      }\n    };\n  }\n}\nfunction createHooks() {\n  return new Hookable();\n}\n\nconst isBrowser = typeof window !== \"undefined\";\nfunction createDebugger(hooks, _options = {}) {\n  const options = {\n    inspect: isBrowser,\n    group: isBrowser,\n    filter: () => true,\n    ..._options\n  };\n  const _filter = options.filter;\n  const filter = typeof _filter === \"string\" ? (name) => name.startsWith(_filter) : _filter;\n  const _tag = options.tag ? `[${options.tag}] ` : \"\";\n  const logPrefix = (event) => _tag + event.name + \"\".padEnd(event._id, \"\\0\");\n  const _idCtr = {};\n  const unsubscribeBefore = hooks.beforeEach((event) => {\n    if (!filter(event.name)) {\n      return;\n    }\n    _idCtr[event.name] = _idCtr[event.name] || 0;\n    event._id = _idCtr[event.name]++;\n    console.time(logPrefix(event));\n  });\n  const unsubscribeAfter = hooks.afterEach((event) => {\n    if (!filter(event.name)) {\n      return;\n    }\n    if (options.group) {\n      console.groupCollapsed(event.name);\n    }\n    if (options.inspect) {\n      console.timeLog(logPrefix(event), event.args);\n    } else {\n      console.timeEnd(logPrefix(event));\n    }\n    if (options.group) {\n      console.groupEnd();\n    }\n    _idCtr[event.name]--;\n  });\n  return {\n    close: () => {\n      unsubscribeBefore();\n      unsubscribeAfter();\n    }\n  };\n}\n\nexport { Hookable, createDebugger, createHooks, flatHooks, mergeHooks, parallelCaller, serial, serialCaller };\n"],"names":["flatHooks","configHooks","hooks","parentName","key","subHook","name","serialCaller","arguments_","promise","hookFunction","parallelCaller","hook","callEachWith","callbacks","argument0","callback","Hookable","function_","options","originalName","dep","message","_unreg","_function","index","deprecated","_hooks","deprecatedHooks","removeFns","unreg","caller","event","result","createHooks"],"mappings":"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"}